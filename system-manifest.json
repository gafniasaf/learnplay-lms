{
  "branding": {
    "name": "LearnPlay Platform",
    "tagline": "Adaptive learning with multi-role insights."
  },
  "data_model": {
    "root_entities": [
      {
        "name": "LearnerProfile",
        "slug": "learner-profile",
        "fields": [
          { "name": "full_name", "type": "string" },
          { "name": "avatar_url", "type": "string" },
          { "name": "grade_level", "type": "string" },
          { "name": "weekly_goal_minutes", "type": "number" },
          { "name": "current_assignment_id", "type": "string" },
          { "name": "goal_status", "type": "string" },
          { "name": "insights_snapshot", "type": "json" }
        ]
      },
      {
        "name": "Assignment",
        "slug": "assignment",
        "fields": [
          { "name": "title", "type": "string" },
          { "name": "status", "type": "enum", "options": ["draft", "scheduled", "in_progress", "graded", "archived"] },
          { "name": "subject", "type": "string" },
          { "name": "due_date", "type": "date" },
          { "name": "adaptive_cluster_id", "type": "string" },
          { "name": "ai_variant_id", "type": "string" },
          { "name": "learner_id", "type": "string" },
          { "name": "teacher_id", "type": "string" },
          { "name": "rubric", "type": "json" },
          { "name": "attachments", "type": "json" }
        ]
      },
      {
        "name": "CourseBlueprint",
        "slug": "course-blueprint",
        "fields": [
          { "name": "title", "type": "string" },
          { "name": "subject", "type": "string" },
          { "name": "difficulty", "type": "enum", "options": ["elementary", "middle", "high", "college"] },
          { "name": "catalog_path", "type": "string" },
          { "name": "multimedia_manifest", "type": "json" },
          { "name": "guard_status", "type": "enum", "options": ["pending", "passed", "failed"] },
          { "name": "published", "type": "boolean" },
          { "name": "notes", "type": "string" },
          { "name": "game_type", "type": "enum", "options": ["mcq", "audio_mcq", "visual_mcq", "drag_drop", "matching", "ordering", "timed_fluency", "numeric", "diagram"] }
        ]
      },
      {
        "name": "GameSession",
        "slug": "game-session",
        "fields": [
          { "name": "assignment_id", "type": "string" },
          { "name": "course_id", "type": "string" },
          { "name": "level", "type": "number" },
          { "name": "status", "type": "enum", "options": ["active", "completed", "abandoned"] },
          { "name": "start_time", "type": "date" },
          { "name": "end_time", "type": "date" },
          { "name": "score", "type": "number" },
          { "name": "accuracy", "type": "number" },
          { "name": "content_version", "type": "string" }
        ]
      },
      {
        "name": "MessageThread",
        "slug": "message-thread",
        "fields": [
          { "name": "title", "type": "string" },
          { "name": "participant_ids", "type": "json" },
          { "name": "last_message", "type": "string" },
          { "name": "unread_counts", "type": "json" },
          { "name": "pinned", "type": "boolean" }
        ]
      },
      {
        "name": "JobTicket",
        "slug": "job-ticket",
        "fields": [
          { "name": "job_type", "type": "string" },
          { "name": "status", "type": "enum", "options": ["queued", "running", "completed", "failed"] },
          { "name": "payload", "type": "json" },
          { "name": "result", "type": "json" },
          { "name": "target_id", "type": "string" }
        ]
      },
      {
        "name": "MasteryState",
        "slug": "mastery-state",
        "fields": [
          { "name": "student_id", "type": "string" },
          { "name": "ko_id", "type": "string" },
          { "name": "mastery", "type": "number" },
          { "name": "status", "type": "enum", "options": ["locked", "in-progress", "mastered"] },
          { "name": "evidence_count", "type": "number" },
          { "name": "last_practiced", "type": "date" }
        ]
      },
      {
        "name": "StudentGoal",
        "slug": "student-goal",
        "fields": [
          { "name": "student_id", "type": "string" },
          { "name": "title", "type": "string" },
          { "name": "target_minutes", "type": "number" },
          { "name": "progress_minutes", "type": "number" },
          { "name": "status", "type": "enum", "options": ["on_track", "behind", "completed"] },
          { "name": "due_at", "type": "date" }
        ]
      },
      {
        "name": "ClassMembership",
        "slug": "class-membership",
        "fields": [
          { "name": "class_id", "type": "string" },
          { "name": "user_id", "type": "string" },
          { "name": "role", "type": "enum", "options": ["student", "teacher"] }
        ]
      }
    ],
    "child_entities": [
      {
        "name": "SessionEvent",
        "slug": "session-event",
        "fields": [
          { "name": "assignment_id", "type": "string" },
          { "name": "question_ref", "type": "string" },
          { "name": "outcome", "type": "enum", "options": ["correct", "incorrect", "skipped", "hint"] },
          { "name": "duration_seconds", "type": "number" },
          { "name": "transcript", "type": "string" },
          { "name": "confidence_score", "type": "number" }
        ]
      },
      {
        "name": "GoalUpdate",
        "slug": "goal-update",
        "fields": [
          { "name": "learner_id", "type": "string" },
          { "name": "week_of", "type": "date" },
          { "name": "target_minutes", "type": "number" },
          { "name": "note", "type": "string" }
        ]
      }
    ]
  },
  "agent_jobs": [
    {
      "id": "draft_assignment_plan",
      "target_entity": "Assignment",
      "execution_mode": "synchronous",
      "ui": {
        "label": "Draft Plan",
        "icon": "Sparkles",
        "placement": "assignment_toolbar"
      },
      "prompt_template": "You are an adaptive learning coach. Given {{title}}, {{subject}}, {{learner_id}}, and recent session context, propose the next best set of activities. Return JSON {\"summary\": string, \"suggested_actions\": string[], \"updated_fields\": {\"ai_variant_id\": string, \"status\": string}}."
    },
    {
      "id": "ai_course_generate",
      "target_entity": "CourseBlueprint",
      "execution_mode": "async",
      "ui": {
        "label": "Generate Course",
        "icon": "WandSparkles",
        "placement": "catalog_builder"
      },
      "prompt_template": "Act as an instructional designer. Using {{subject}}, {{difficulty}}, and {{multimedia_manifest}}, output a full HTML/JSON pack with sections, objectives, CTA copy, and audio/video transcript references."
    },
    {
      "id": "guard_course",
      "target_entity": "CourseBlueprint",
      "execution_mode": "synchronous",
      "ui": {
        "label": "Run Guard",
        "icon": "ShieldCheck",
        "placement": "catalog_builder"
      },
      "prompt_template": "Review the provided course blueprint for missing CTAs, accessibility violations, and policy blockers. Respond with JSON {\"summary\": string, \"violations\": string[], \"status\": \"passed\"|\"failed\"}."
    },
    {
      "id": "compile_mockups",
      "target_entity": "CourseBlueprint",
      "execution_mode": "async",
      "prompt_template": "Compile supplied mockup HTML into React routes. Ensure every data-cta-id is preserved. Return JSON {\"success\": boolean, \"files_generated\": string[], \"errors\": string[]}."
    },
    {
      "id": "plan_matrix_run",
      "target_entity": "JobTicket",
      "execution_mode": "async",
      "prompt_template": "Execute the LearnPlay regression checklist (CTA clicks, guard job, accessibility). Return JSON {\"total_tests\": number, \"passed\": number, \"failed\": number, \"details\": [{\"name\": string, \"status\": string, \"notes\": string}]}."
    }
  ],
  "generation": {
    "default_protocol": "standard",
    "protocols": {
      "ec-expert": {
        "name": "ExpertCollege Exercise Protocol",
        "description": "Two-pass generation: Extract learning objectives from study text, then generate 3-5 exercise variants per objective using Bloom's taxonomy. Output in Dutch.",
        "requires_study_text": true,
        "locale": "nl-NL",
        "output_structure": "objectives_with_sets"
      },
      "standard": {
        "name": "Standard Generation",
        "description": "Traditional skeleton + filler approach for course generation",
        "requires_study_text": false,
        "output_structure": "flat_items"
      }
    }
  },
  "edge_functions": [
    { "id": "validate-course-structure", "input": { "courseId": "string" }, "output": { "ok": "boolean" } },
    { "id": "generate-variants-audit", "input": { "courseId": "string" }, "output": { "ok": "boolean", "coverage": "number" } },
    { "id": "editor-repair-course", "input": { "courseId": "string", "apply": "boolean" }, "output": { "ok": "boolean", "preview": "json" } },
    { "id": "editor-variants-missing", "input": { "courseId": "string", "apply": "boolean" }, "output": { "ok": "boolean", "preview": "json" } },
    { "id": "editor-auto-fix", "input": { "courseId": "string", "apply": "boolean" }, "output": { "ok": "boolean" } },
    { "id": "editor-co-pilot", "input": { "action": "string", "subject": "string", "format": "string", "courseId": "string", "locale": "string" }, "output": { "jobId": "string" } },
    { "id": "generate-hint", "input": { "courseId": "string", "itemId": "number" }, "output": { "ok": "boolean", "courseId": "string", "itemId": "number", "hint": "string" } },
    { "id": "enrich-hints", "input": { "courseId": "string", "itemIds": "json" }, "output": { "ok": "boolean", "courseId": "string", "updatedItemIds": "json", "count": "number" } },
    { "id": "generate-assignment", "input": { "topic": "string" }, "output": { "jobId": "string" } },
    { "id": "generate-remediation", "input": { "subject": "string", "itemsPerGroup": "number" }, "output": { "jobId": "string" } },
    { "id": "mcp-metrics-proxy", "input": { "type": "string" }, "output": { "ok": "boolean" } },
    { "id": "game-start-round", "input": { "courseId": "string", "level": "number", "assignmentId": "string" }, "output": { "sessionId": "string", "roundId": "string" } },
    { "id": "game-log-attempt", "input": { "roundId": "string", "itemId": "number", "isCorrect": "boolean", "latencyMs": "number", "finalize": "boolean" }, "output": { "attemptId": "string" } },
    { "id": "get-analytics", "input": { "courseId": "string", "range": "string" }, "output": { "dailyData": "json", "summary": "json" } },
    { "id": "get-student-skills", "input": { "studentId": "string", "domain": "string", "status": "string" }, "output": { "skills": "json", "totalCount": "number" } },
    { "id": "update-mastery", "input": { "studentId": "string", "koId": "string", "exerciseScore": "number" }, "output": { "oldMastery": "number", "newMastery": "number" } },
    { "id": "get-domain-growth", "input": { "studentId": "string" }, "output": { "domains": "json" } },
    { "id": "get-recommended-courses", "input": { "koId": "string", "studentId": "string" }, "output": { "courses": "json" } },
    { "id": "create-class", "input": { "name": "string", "description": "string" }, "output": { "class": "json" } },
    { "id": "add-class-member", "input": { "classId": "string", "studentEmail": "string" }, "output": { "ok": "boolean" } },
    { "id": "remove-class-member", "input": { "classId": "string", "studentId": "string" }, "output": { "ok": "boolean" } },
    { "id": "invite-student", "input": { "orgId": "string", "classId": "string", "email": "string" }, "output": { "inviteId": "string", "success": "boolean" } },
    { "id": "generate-class-code", "input": { "classId": "string", "refreshCode": "boolean" }, "output": { "code": "string", "expiresAt": "string" } },
    { "id": "join-class", "input": { "code": "string" }, "output": { "success": "boolean", "classId": "string" } },
    { "id": "create-child-code", "input": { "studentId": "string" }, "output": { "code": "string", "expiresAt": "string" } },
    { "id": "link-child", "input": { "code": "string" }, "output": { "success": "boolean", "childId": "string" } },
    { "id": "send-message", "input": { "recipientId": "string", "content": "string" }, "output": { "messageId": "string", "success": "boolean" } },
    { "id": "list-conversations", "input": {}, "output": { "conversations": "json" } },
    { "id": "list-messages", "input": { "conversationWith": "string", "limit": "number" }, "output": { "messages": "json", "nextCursor": "string" } }
  ]
}

