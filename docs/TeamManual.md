# Ignite Zero Team Playbook

## 0 ¬∑ Preface ‚Äì The system we‚Äôre stewarding
Ignite Zero is more than an AI playground. It‚Äôs a full-stack Factory built to shepherd ideas from spark ‚Üí blueprint ‚Üí working software without losing our soul along the way. Three promises drive everything inside:

1. **Aligned Ambition** ‚Äì Clear PLAN.md blueprints, tradeoffs, and rituals for Cursor.
2. **Secure Delivery** ‚Äì Every release zip travels through a gated pipeline (edge function + signed URLs + PowerShell bootstrap) so we never worry about stale builds or mystery binaries.
3. **Continuous Execution** ‚Äì Cursor, MCP jobs, and the Watchtower are wired together so background strategies, PLAN.md tasks, and real-time logs stay in sync.

This playbook walks through the entire system like a story: why each piece exists, how it interacts with the others, and what to do when it‚Äôs your turn at the controls.

---

## 1 ¬∑ Ignite Zero at a glance
| Component | Purpose | Problems it solves |
| --- | --- | --- |
| **Workspace Console** | Product room for planning, evolution, and monitoring. | Prevents half-baked roadmaps, documents every plan, forces high-quality specs. |
| **Secure Release Service** (`/setup` + edge function) | Serves private release zips via signed URLs and powers the PowerShell bootstrap. | Keeps builds consistent, avoids ‚Äúwhich zip?‚Äù confusion, blocks unauthorized downloads. |
| **PLAN.md Pipeline** | PLAN.md download/upload workflow plus Cursor instructions. | Guarantees that human intent travels intact into automated execution. |
| **Watchtower** | Live MCP job feed from Supabase realtime. | Gives visibility into background strategies so we debug proactively. |
| **Lovable Frontend Mirror** | Always-on hosted preview that syncs with `main`. | Everyone sees the same UI, Lovable captures build errors, and every push to `main` automatically redeploys. |
| **Cursor + MCP strategies** | The actual builders. They consume PLAN.md, run long jobs, stream results. | Keeps humans freed up for product thinking instead of mechanical tasks. |

When you‚Äôre walking through the Factory in later sections, just remember: each ritual (login, download, consult, plan, run) is tied back to one of these pillars.

### Key terms & how they connect
- **MCP (Model Context Protocol server)** ‚Äì Our local/control-plane service that runs long-lived ‚Äústrategies‚Äù (generate subtasks, auto-split work, etc.) in the background. When the UI enqueues a job, MCP picks it up and streams progress into the Watchtower.
- **Edge Function** ‚Äì A Supabase serverless endpoint we deploy next to our data. `download-release` is an edge function that validates a user session and creates signed URLs for private files.
- **Cursor** ‚Äì The AI coding partner that reads PLAN.md and executes step-by-step, checking off items as it goes.
- **PLAN.md** ‚Äì The contract between humans and Cursor; generated by the Architect, stored in Supabase, and downloaded locally so teammates can inspect/modify it.
- **Watchtower** ‚Äì A simple realtime dashboard inside `/architect` that subscribes to `ai_agent_jobs` via Supabase Realtime so we can see what MCP is doing.
- **Bootstrap Script (`install-factory.ps1`)** ‚Äì A PowerShell helper that installs prerequisites and pulls the latest release zip when given a signed URL.

---

## 2 ¬∑ How the story flows (idea ‚Üí launch)
1. **Describe the mission** ‚Äì Use the planning flow to write the plain-English goal. The AI reframes it, lists tradeoffs, and produces a PLAN.md.
2. **Consult & refine** ‚Äì If the plan needs sharper edges, use the chat sidecar. The consultant asks clarifying questions, adds discovery notes, and regenerates the plan with context.
3. **Preview & approve the HTML mockup** ‚Äì Before PLAN.md unlocks, review the lightweight HTML mock that mirrors the proposed UI. Approve it so Cursor has a visual reference later.
4. **Hand off to Cursor** ‚Äì Downloading PLAN.md also uploads it to Supabase Storage. We copy the ‚ÄúCursor Instructions‚Äù so the AI agent knows where the plan lives.
5. **Build & observe** ‚Äì Cursor runs through PLAN.md tasks, while MCP strategies execute longer jobs (auto-splitting tasks, generating subtasks, etc.). Watchtower shows their progress in real time.
6. **Release to humans** ‚Äì When it‚Äôs time to share a build, `/setup` gives us a fresh zip via the secure edge function. The PowerShell script pulls from the same signed URL to keep new teammates in sync.
7. **Iterate** ‚Äì The ‚ÄúModify Existing‚Äù tab lets us evolve the same system without losing previous insights, because every plan + consult log is stored and resumable.

That‚Äôs the loop. Everything else in this playbook zooms into the individual beats so you know exactly what to click and why.

---

## 3 ¬∑ Getting access (the literal keys)
- **Login URL:** `https://<your-domain>/auth`
- Use ‚ÄúForgot password‚Äù to set your own credentials. Need additional users? Add them via Supabase Auth and they‚Äôll get the same gated experience.

After logging in, you‚Äôre cleared for `/setup` and `/my-app`. Anonymous sessions are bounced back to `/auth`, so share credentials responsibly.

---

## 4 ¬∑ Downloading the release the right way
1. Navigate to `/setup`.
2. Click **‚ÄúDownload ignite-zero.zip.‚Äù** This triggers the `download-release` edge function (a Supabase-hosted serverless endpoint) which:
   - Confirms your Supabase session.
   - Generates a one-hour signed URL for the private `releases/ignite-zero-release.zip`.
   - Streams the file immediately.
3. Need to feed the PowerShell script? Copy the signed URL we show below the button and run:
   ```powershell
   .\install-factory.ps1 -ReleaseUrl "<signed-url>"
   ```
4. Signed URL expired? Just click the button again; it‚Äôs cheap and safe.
5. **Fallback:** If the edge function is down, the script now defaults to the latest public build at `https://zhrhuxjagenhhhttphmu.supabase.co/storage/v1/object/public/releases/ignite-zero-release.zip`. Use it only when the signed link is unavailable‚Äîwe still prefer the gated flow for day-to-day installs.

> **Why download if Lovable hosts the UI?**  
> The zip is the source of truth for Cursor and Git operations. We make code changes locally, commit, and push to `main`. Lovable watches that branch, so every push turns into a new hosted build without anybody running `npm run dev` on their laptop.

### PowerShell bootstrap (optional but magical)
```powershell
Set-ExecutionPolicy Bypass -Scope Process -Force
iwr https://<your-domain>/install-factory.ps1 -UseBasicParsing | iex
```
When prompted, paste the latest signed link. The script installs Git, Node LTS, Docker Desktop, Supabase CLI, GitHub Desktop, and unpacks the zip into `~/IgniteZero`. Walk away and let it do the chores.

> **Note**: Docker Desktop is now **automatically started** when needed by the system. You don't need to manually start it before running commands.

---

## 5 ¬∑ Running the Factory + Lovable preview
```bash
npm install                  # dependencies + lint hooks
cd lms-mcp && npm run dev    # optional: local MCP server (Model Context Protocol jobs)
cd .. && npm run factory     # menu-driven launcher + verifier
```
- Option `1` in `npm run factory` opens Vite on `http://localhost:5173/`.
- `npm run verify` = typecheck + unit tests + CTA/coverage checks.

Hot tip: keep the MCP server running in another terminal so background strategies can execute as soon as you enqueue jobs from the UI.

### Verification ritual (`npm run verify`)
`npm run verify` is our pre-push gate. It runs, in order:
1. **Contract presence** ‚Äì `src/lib/contracts.ts` exists and isn‚Äôt empty.
2. **Type safety** ‚Äì `npm run typecheck`.
3. **Unit tests** ‚Äì `npm run test`.
4. **LearnPlay E2E tests** ‚Äì `tests/e2e/learnplay-journeys.spec.ts` presence for core user journey coverage.

If you break any of those, fix it locally before you push‚ÄîLovable, Cursor, and the MCP loop all depend on this script staying green.

> ‚úÖ **Lint status**
>
> `npm run lint` now succeeds across the repo (generated reports, Supabase edge code, and CLI scripts are excluded from the lint target). Run it before you push so Husky doesn‚Äôt have to be bypassed, and treat any new warnings in `src/` as a sign to tighten types before merging.

### Lovable is the canonical frontend
- The Lovable workspace hosts `/architect`, `/setup`, and `/my-app` for everyone. We rely on its preview URL instead of local Vite for demos, QA, and telemetry.
- Lovable watches the `main` branch on GitHub. When `main` changes, Lovable pulls, builds, and redeploys automatically, surfacing any build errors in its console.
- If Lovable fixes are applied directly in the designer, they commit back to `main`. Always pull before you start coding so Cursor doesn‚Äôt diverge from Lovable‚Äôs copy.

### Two-way sync with GitHub `main`
1. `git pull origin main` before editing‚Äîthis brings down any last-minute Lovable edits or teammate commits.
2. Make your changes locally (Cursor, tests, scripts) and run `npm run verify`.
3. `git commit` and `git push origin main`. This push is the trigger that tells Lovable to rebuild the hosted UI.
4. Watch Lovable‚Äôs build log. If it fails, fix locally, push again, or apply a hot patch inside Lovable and hit ‚ÄúSync to GitHub,‚Äù then `git pull`.

### Why pushing to `main` matters
- Lovable only deploys what‚Äôs on `main`; unpushed work never shows up in the hosted UI.
- Two-way sync keeps Cursor, MCP, and Lovable aligned. Skipping the push leaves teammates on an old build and produces the ‚Äústill old UI‚Äù issue we‚Äôve already seen.
- `main` is therefore our shared truth: Lovable mirrors it, CI runs on it, and release zips are cut from it.

---


## 7 ¬∑ Release safety net (because ops matters)
1. `/setup` download button ‚Üí `download-release` function ‚Üí signed URL ‚Üí private zip.
2. PowerShell script always runs with `-ReleaseUrl "<signed-url>"`.
3. `npm run release:publish`:
   - `git archive`s the repo into `ignite-zero-release.zip`.
   - Uploads it to the `releases` bucket via Supabase CLI.
   - Cleans up the local zip, updates `.env.local`, refreshes `install-factory.ps1`.
4. `npm run push:release` if you want a one-liner that pushes `main` **and** immediately republishes the release zip (use it instead of `git push` when you know the download should update right away).

If Supabase storage is under maintenance, the script will warn you. Just rerun once status.supabase.com is green again.

> **CLI housekeeping:** The publish script expects a recent Supabase CLI. If you see warnings about ‚ÄúA new version of Supabase CLI is available,‚Äù run `supabase update` (or reinstall via winget/homebrew) before retrying.

---

## 8 ¬∑ Troubleshooting stories
| Scenario | What‚Äôs probably happening | What to do |
| --- | --- | --- |
| Download button says ‚ÄúUnauthorized‚Äù | Session cookie expired or you opened a private window. | Log back in at `/auth`, then revisit `/setup`. |
| PowerShell bootstrap fails saying ReleaseUrl missing | The signed link timed out. | Click the download button again, copy the new URL, rerun `install-factory.ps1 -ReleaseUrl "<link>"`. |
| Supabase CLI errors during `release:publish` | Supabase maintenance window or stale CLI login. | Re-auth the CLI (see `docs/DEPLOYMENT_MAGIC.md`), then rerun once status.supabase.com is green again. |
| Watchtower is empty | MCP server isn't running or jobs haven't started. | Start `npm run mcp:ensure` (Docker auto-starts if needed) or check `lms-mcp` logs. |
| Docker won't start | Docker Desktop installation issue or system resources. | Run `npm run docker:check` to diagnose, or manually open Docker Desktop. See `docs/DOCKER_AUTO_START.md`. |
| Playwright tests bypass auth | We intentionally set `VITE_BYPASS_AUTH=true` only for Playwright's web server. | Ignore in CI; production builds never set this flag. |

---

## 9 ¬∑ Handy commands at a glance
```bash
# Rebuild + upload the release archive
npm run release:publish

# Push main and republish in one go
npm run push:release

# Full confidence run (unit + integration + e2e)
npm run test:all

# Deploy the secure download edge function
cd supabase
supabase functions deploy download-release
```

---

Share this playbook with anyone stepping into Ignite Zero. It tells the full story‚Äîwhy the Factory exists, how the pieces dance together, and exactly where to click when it‚Äôs your turn on the controls. If someone needs new credentials or the release bot hiccups, ping whoever is on Supabase duty. Happy building! üöÄ


